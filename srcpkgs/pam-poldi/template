# Template file for 'pam-poldi'
pkgname=pam-poldi
version=0.4.2
revision=1
# the git-hash of v0.4.2 as it isn't tagged
_githash=d9a9ff970ecbc57758a243858d30cbb398b7315e
wrksrc="poldi-${_githash:0:7}"
build_style=gnu-configure
configure_args="--with-pam-module-directory=/usr/lib/security --sysconfdir=/etc"
hostmakedepends="automake gettext-devel"
makedepends="libgcrypt-devel libksba-devel libgpg-error-devel pam-devel"
depends="gnupg2-scdaemon"
short_desc="PAM module for authentication using a smartcard"
maintainer="ap4y <mail@ap4y.me>"
license="GPL-3.0-or-later"
homepage="http://www.g10code.com/p-poldi.html"
distfiles="http://git.gnupg.org/cgi-bin/gitweb.cgi?p=poldi.git;a=snapshot;h=${_githash};sf=tgz>poldi-${version}.tar.gz"
checksum=9dea989aa54635321f56bee74c3abe894d297d5e9edef964057b21e0c97a56b7

pre_configure() {
	echo "@set VERSION ${_version}" > doc/version.texi
	autoreconf -fi
}

post_install() {
	vsconf conf/poldi.conf.skel poldi.conf
	vsconf conf/scdaemon.conf.skel scdaemon.conf
	vsconf conf/users.skel users

	vlicense COPYING
}
